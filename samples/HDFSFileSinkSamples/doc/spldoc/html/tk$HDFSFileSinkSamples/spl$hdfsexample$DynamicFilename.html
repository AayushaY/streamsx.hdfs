<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="reference"/>
<meta name="DC.Title" content="SPL File DynamicFilename.spl"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="spldoc_compilationunit"/>
<link rel="stylesheet" type="text/css" href="../../html/commonltr.css"/>
<link rel="stylesheet" type="text/css" href="../../html/spldoc.css"/>
<title>SPL File DynamicFilename.spl</title>
</head>
<body id="spldoc_compilationunit">


<h1 class="title topictitle1">SPL File <tt class="ph tt">DynamicFilename.spl</tt></h1>

<div class="body refbody">
<div class="section">
<p class="p">
<a class="xref" href="../toolkits/toolkits.html">Toolkits</a> &gt; <a class="xref" href="tk$HDFSFileSinkSamples.html">HDFSFileSinkSamples 1.0.0</a> &gt; <a class="xref" href="ns$hdfsexample.html">hdfsexample</a> &gt; DynamicFilename.spl</p>

</div>

<div class="section"><h2 class="title sectiontitle splhead-1">Content</h2>
  
    <dl class="dl">
    <dt class="dt dlterm"/>
<dd class="dd"/>

    
      <dt class="dt dlterm splhead-2">Composite Operators</dt>

      <dd class="dd"><ul class="sl simple">
<li class="sli"><strong class="ph b"><a class="xref" href="#spldoc_compilationunit__composite_operator__DynamicFilename">composite DynamicFilename</a></strong>: Demonstrates the use of the dynamicFilename parameter.
</li>

     </ul>
</dd>

    
    
      <dt class="dt dlterm splhead-2">Functions</dt>

      <dd class="dd"><ul class="sl simple">
<li class="sli"><strong class="ph b"><a class="xref" href="#spldoc_compilationunit__function__getFileName.uint64">rstring getFileName(uint64 n)</a></strong>: Returns a filename for a particular iteration.
</li>

     </ul>
</dd>

    
     </dl>

</div>

<div class="section"><h2 class="title sectiontitle splhead-1">Composite Operators</h2>
  
</div>

<div class="section" id="spldoc_compilationunit__composite_operator__DynamicFilename"><h2 class="title sectiontitle splpart">composite DynamicFilename</h2>
  
</div>

<div class="section">

<p class="p">Demonstrates the use of the dynamicFilename parameter.
</p>

<p class="p">In this composite, the Beacon operator produces tuples with two attributes.  The first is the data to be written, and the second is the name to use to write it.   When this second attribute changes (and only then), the current file is closed, and the file name is re-evaluated.  
</p>

<p class="p">In this example, the Beacon produces 100 tuples.  We call the function getFileName to get the prefix to use for the file, and then also append a filenum and the time. For example, for the first thirty tuples, the filename expression is  firstFile%FILENUM_%TIME.txt
</p>

<p class="p">Notice that while the time is different for each of those thirty tuples, the string substituations only happen on the <em class="ph i">first</em> tuple, and all subsequent tuples with the same string go into the same file.  
</p>

<p class="p">The result of the running writes four files.  My four files are below (when you run, your times will be different): &lt;code&gt; "firstFile0_20140611_140008.txt",710 "secondFile1_20140611_140038.txt",720 "thirdFile2_20140611_140108.txt",720 "fourthFile3_20140611_140138.txt",240 &lt;/code&gt; 
</p>

</div>

<div class="section">
</div>

<div class="section">
</div>

<div class="section">
</div>

<div class="section"><h2 class="title sectiontitle splhead-2">Composite Operator Graph</h2>
  
</div>

<div class="section splgraph">
<object type="image/svg+xml" data="../../image/tk$HDFSFileSinkSamples/op$hdfsexample$DynamicFilename.svg" width="447" height="154">
<span>SPL composite operator image not displayed. Problem loading file: ../../image/tk$HDFSFileSinkSamples/op$hdfsexample$DynamicFilename.svg
</span>
</object>
</div>

<div class="section"><h2 class="title sectiontitle splhead-1">Functions</h2>
  
</div>

<div class="section" id="spldoc_compilationunit__function__getFileName.uint64"><h2 class="title sectiontitle splpart">rstring getFileName(uint64 n)</h2>
  
</div>
<div class="section">

<p class="p">Returns a filename for a particular iteration.
</p>

<p class="p">This function is provided to demonstrate one way of using the dynamic filename feature.  In a more realistic usecase, you'd probably call such a file on a full tuple, and use fields of the tuple to generate a file name.  remember, though, that this is called for every tuple, so you want to avoid heavy-weight operations. 
</p>

</div>

<div class="section"><h2 class="title sectiontitle">Parameters</h2>

 <ul class="sl simple">
   <li class="sli">
<strong class="ph b">n</strong>: 
   </li>

 </ul>

</div>

<div class="section"><h2 class="title sectiontitle">Returns</h2>

<ul class="sl simple"><li class="sli">
<tt class="ph tt">rstring</tt>
</li>
</ul>

</div>

</div>


</body>
</html>